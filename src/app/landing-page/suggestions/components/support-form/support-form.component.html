<div class="support-options">
  <div class="quick-help" role="complementary" aria-labelledby="quickHelpTitle">
    <h3 id="quickHelpTitle">Quick Help</h3>
    <div class="faq-section">
      <div class="faq-item" *ngFor="let faq of faqs; let i = index">
        <button
          class="faq-button"
          (click)="toggleFaq.emit(faq)"
          [attr.aria-expanded]="faq.isOpen"
          [attr.aria-controls]="'faq-answer-' + i"
        >
          <span class="faq-question">{{ faq.question }}</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            aria-hidden="true"
            [class.rotate]="faq.isOpen"
          >
            <path d="m6 9 6 6 6-6"></path>
          </svg>
        </button>
        <div
          class="faq-answer"
          [class.show]="faq.isOpen"
          [id]="'faq-answer-' + i"
          role="region"
          [attr.aria-hidden]="!faq.isOpen"
        >
          {{ faq.answer }}
        </div>
      </div>
    </div>
  </div>

  <div class="contact-support">
    <h3>Contact Support</h3>
    <form
      [formGroup]="form"
      (ngSubmit)="onSubmit()"
      class="support-form"
      role="form"
      aria-label="Support Request Form"
    >
      <div class="form-group" role="group" aria-labelledby="nameLabel">
        <label id="nameLabel" for="name">
          Name
          <span class="required-asterisk" aria-hidden="true">*</span>
          <span class="sr-only">required</span>
        </label>
        <input
          type="text"
          id="name"
          formControlName="name"
          placeholder="Your full name"
          class="form-input"
          aria-required="true"
          [attr.aria-invalid]="
            form.get('name')?.touched && form.get('name')?.invalid
          "
          aria-describedby="nameError"
        />
        <div
          class="error-message"
          id="nameError"
          *ngIf="form.get('name')?.touched && form.get('name')?.invalid"
          role="alert"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
          Name is required
        </div>
      </div>

      <div class="form-group" role="group" aria-labelledby="emailLabel">
        <label id="emailLabel" for="email">
          Email
          <span class="required-asterisk" aria-hidden="true">*</span>
          <span class="sr-only">required</span>
        </label>
        <input
          type="email"
          id="email"
          formControlName="email"
          placeholder="your@email.com"
          class="form-input"
          aria-required="true"
          [attr.aria-invalid]="
            form.get('email')?.touched && form.get('email')?.invalid
          "
          aria-describedby="emailError"
        />
        <div
          class="error-message"
          id="emailError"
          *ngIf="form.get('email')?.touched && form.get('email')?.invalid"
          role="alert"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
          Please enter a valid email address
        </div>
      </div>

      <div class="form-group" role="group" aria-labelledby="issueTypeLabel">
        <label id="issueTypeLabel" for="issueType">
          Issue Type
          <span class="required-asterisk" aria-hidden="true">*</span>
          <span class="sr-only">required</span>
        </label>
        <div class="select-wrapper">
          <select
            id="issueType"
            formControlName="issueType"
            class="form-input"
            aria-required="true"
            [attr.aria-invalid]="
              form.get('issueType')?.touched && form.get('issueType')?.invalid
            "
            aria-describedby="issueTypeError"
          >
            <option value="" disabled selected>Select issue type</option>
            <option value="technical">Technical Problem</option>
            <option value="account">Account Related</option>
            <option value="billing">Billing Question</option>
            <option value="data">Data Related</option>
            <option value="other">Other</option>
          </select>
        </div>
        <div
          class="error-message"
          id="issueTypeError"
          *ngIf="
            form.get('issueType')?.touched && form.get('issueType')?.invalid
          "
          role="alert"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
          Please select an issue type
        </div>
      </div>

      <div class="form-group" role="group" aria-labelledby="messageLabel">
        <label id="messageLabel" for="message">
          Message
          <span class="required-asterisk" aria-hidden="true">*</span>
          <span class="sr-only">required</span>
        </label>
        <textarea
          id="message"
          formControlName="message"
          placeholder="Please describe your issue in detail..."
          rows="6"
          class="form-input"
          aria-required="true"
          [attr.aria-invalid]="
            form.get('message')?.touched && form.get('message')?.invalid
          "
          aria-describedby="messageHint messageError"
        ></textarea>
        <div class="input-hint" id="messageHint">
          Include any relevant details that might help us assist you better
        </div>
        <div
          class="error-message"
          id="messageError"
          *ngIf="form.get('message')?.touched && form.get('message')?.invalid"
          role="alert"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
          Message is required (minimum 20 characters)
        </div>
      </div>

      <button
        type="submit"
        class="submit-button"
        [disabled]="!form.valid"
        [attr.aria-disabled]="!form.valid"
      >
        <span>Submit Support Request</span>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          aria-hidden="true"
        >
          <path d="M5 12h14M12 5l7 7-7 7"></path>
        </svg>
      </button>
    </form>
  </div>
</div>

<div class="daily-food-log">
  <div class="meals-grid">
    <div class="meal-card">
      <div class="meal-content">
        <div class="meal-header">
          <h2 class="meal-title">Breakfast</h2>
          <div class="oxalate-totals">
            <span class="total-oxalate"
              >Total Oxalate: {{ breakfastTotal }}</span
            >
            <span class="total-soluble-oxalate"
              >Total Soluble Oxalate: {{ breakfastSolubleTotal }}</span
            >
          </div>
        </div>

        <div class="food-list" *ngIf="breakfastItems.length > 0">
          <div
            *ngFor="let food of breakfastItems; let i = index"
            class="food-item"
          >
            <div class="food-details">
              <span class="food-name">{{ food.foodName }}</span>
              <span class="food-info"
                >{{ food.servingSize }}g serving size,
                {{ food.numberOfServings }} servings</span
              >
            </div>
            <button
              class="delete-btn"
              (click)="deleteFood('breakfast', i)"
              [attr.aria-label]="'Delete ' + food.foodName"
            >
              <i class="material-icons">close</i>
            </button>
          </div>
        </div>

        <div class="empty-state" *ngIf="breakfastItems.length === 0">
          <span>No foods added yet</span>
        </div>

        <button class="add-food-btn" (click)="openCalculator('breakfast')">
          <i class="material-icons">add</i>
          <span class="btn-text">Add Food</span>
        </button>
      </div>
    </div>

    <div class="meal-card">
      <div class="meal-content">
        <div class="meal-header">
          <h2 class="meal-title">Lunch</h2>
          <div class="oxalate-totals">
            <span class="total-oxalate">Total Oxalate: {{ lunchTotal }}</span>
            <span class="total-soluble-oxalate"
              >Total Soluble Oxalate: {{ lunchSolubleTotal }}</span
            >
          </div>
        </div>

        <div class="food-list" *ngIf="lunchItems.length > 0">
          <div *ngFor="let food of lunchItems; let i = index" class="food-item">
            <div class="food-details">
              <span class="food-name">{{ food.foodName }}</span>
              <span class="food-info"
                >{{ food.servingSize }}g serving size,
                {{ food.numberOfServings }} servings</span
              >
            </div>
            <button
              class="delete-btn"
              (click)="deleteFood('lunch', i)"
              [attr.aria-label]="'Delete ' + food.foodName"
            >
              <i class="material-icons">close</i>
            </button>
          </div>
        </div>

        <div class="empty-state" *ngIf="lunchItems.length === 0">
          <span>No foods added yet</span>
        </div>

        <button class="add-food-btn" (click)="openCalculator('lunch')">
          <i class="material-icons">add</i>
          <span class="btn-text">Add Food</span>
        </button>
      </div>
    </div>

    <div class="meal-card">
      <div class="meal-content">
        <div class="meal-header">
          <h2 class="meal-title">Dinner</h2>
          <div class="oxalate-totals">
            <span class="total-oxalate">Total Oxalate: {{ dinnerTotal }}</span>
            <span class="total-soluble-oxalate"
              >Total Soluble Oxalate: {{ dinnerSolubleTotal }}</span
            >
          </div>
        </div>

        <div class="food-list" *ngIf="dinnerItems.length > 0">
          <div
            *ngFor="let food of dinnerItems; let i = index"
            class="food-item"
          >
            <div class="food-details">
              <span class="food-name">{{ food.foodName }}</span>
              <span class="food-info"
                >{{ food.servingSize }}g serving size,
                {{ food.numberOfServings }} servings</span
              >
            </div>
            <button
              class="delete-btn"
              (click)="deleteFood('dinner', i)"
              [attr.aria-label]="'Delete ' + food.foodName"
            >
              <i class="material-icons">close</i>
            </button>
          </div>
        </div>

        <div class="empty-state" *ngIf="dinnerItems.length === 0">
          <span>No foods added yet</span>
        </div>

        <button class="add-food-btn" (click)="openCalculator('dinner')">
          <i class="material-icons">add</i>
          <span class="btn-text">Add Food</span>
        </button>
      </div>
    </div>

    <div class="meal-card">
      <div class="meal-content">
        <div class="meal-header">
          <h2 class="meal-title">Snacks</h2>
          <div class="oxalate-totals">
            <span class="total-oxalate">Total Oxalate: {{ snacksTotal }}</span>
            <span class="total-soluble-oxalate"
              >Total Soluble Oxalate: {{ snacksSolubleTotal }}</span
            >
          </div>
        </div>

        <div class="food-list" *ngIf="snackItems.length > 0">
          <div *ngFor="let food of snackItems; let i = index" class="food-item">
            <div class="food-details">
              <span class="food-name">{{ food.foodName }}</span>
              <span class="food-info"
                >{{ food.servingSize }}g serving size,
                {{ food.numberOfServings }} servings</span
              >
            </div>
            <button
              class="delete-btn"
              (click)="deleteFood('snacks', i)"
              [attr.aria-label]="'Delete ' + food.foodName"
            >
              <i class="material-icons">close</i>
            </button>
          </div>
        </div>

        <div class="empty-state" *ngIf="snackItems.length === 0">
          <span>No foods added yet</span>
        </div>

        <button class="add-food-btn" (click)="openCalculator('snacks')">
          <i class="material-icons">add</i>
          <span class="btn-text">Add Food</span>
        </button>
      </div>
    </div>
  </div>

  <div class="calculate-container">
    <button class="calculate-btn" (click)="calculateDailyOxalate()">
      Calculate Daily Oxalate
    </button>
  </div>
</div>

<div class="calculator-dialog" *ngIf="showCalculator" [@dialogAnimation]>
  <div class="dialog-overlay" (click)="closeCalculator()"></div>
  <div class="dialog-content">
    <app-calculate-oxalate
      [mealType]="selectedMealType"
      (mealLogged)="onMealLogged($event)"
    ></app-calculate-oxalate>
  </div>
</div>
